<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profile - EthioGov Public Service</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
  body { background: #f5f7fa; color: #333; display:flex; flex-direction:column; min-height:100vh; padding-top:60px;}
  header { background: linear-gradient(135deg, #2D5F84 0%, #1E3A5F 100%); color:white; padding:0 1.5rem; display:flex; justify-content:space-between; align-items:center; height:60px; position:fixed; top:0; left:0; width:100%; z-index:1000;}
  header h1 { font-size:1.2rem;}
  .back-btn { background: rgba(255,255,255,0.2); border:none; color:white; padding:0.5rem 1rem; border-radius:5px; cursor:pointer; display:flex; align-items:center; gap:8px;}
  main { flex:1; max-width:800px; margin:2rem auto; padding:1.5rem; background:white; border-radius:12px; box-shadow:0 5px 15px rgba(0,0,0,0.1);}
  .profile-header { display:flex; align-items:center; gap:1.5rem; margin-bottom:2rem;}
  .profile-pic { width:80px; height:80px; border-radius:50%; background:#ddd; display:flex; align-items:center; justify-content:center; font-size:2rem; color:#555;}
  .profile-info h2 { color:#1E3A5F; font-size:1.5rem;}
  .profile-card { margin-bottom:1.5rem; padding:1rem; border-radius:10px; border:1px solid #ddd;}
  .profile-card label { font-weight:bold; color:#1E3A5F; display:block; margin-bottom:0.3rem;}
  .profile-card input { width:100%; padding:0.6rem; border:1px solid #ccc; border-radius:6px; font-size:1rem;}
  .btn { display:inline-block; background:#2D5F84; color:white; padding:0.8rem 1.5rem; border:none; border-radius:6px; text-decoration:none; cursor:pointer; transition:background 0.3s;}
  .btn:hover { background:#1E3A5F;}
  .message { margin-bottom:1rem; text-align:center; color:red; font-weight:bold;}
  footer { background:#1E3A5F; color:white; padding:1.5rem; text-align:center; margin-top:auto;}
  footer .footer-nav { display:flex; justify-content:center; gap:2rem; margin-bottom:1rem;}
  footer .footer-nav a { color:white; text-decoration:none; display:flex; flex-direction:column; align-items:center;}
</style>
</head>
<body>
<header>
  <h1>Profile</h1>
  <button class="back-btn" onclick="window.history.back()"><i class="fas fa-arrow-left"></i> Back</button>
</header>

<main>
  <p class="message" id="statusMessage">Checking server...</p>

  <div class="profile-header" id="profileHeader" style="display:none;">
    <div class="profile-pic"><i class="fas fa-user"></i></div>
    <div class="profile-info">
      <h2 id="profileName"></h2>
      <p id="profileEmail"></p>
    </div>
  </div>

  <div id="profileFields" style="display:none;">
    <div class="profile-card">
      <label for="name">Full Name</label>
      <input type="text" id="name" disabled>
    </div>

    <div class="profile-card">
      <label for="email">Email</label>
      <input type="email" id="email" disabled>
    </div>

    <div class="profile-card">
      <label for="phone">Phone</label>
      <input type="text" id="phone" disabled>
    </div>

    <button class="btn" id="editBtn">Edit Profile</button>
    <button class="btn" id="saveBtn" style="display:none;">Save Changes</button>
  </div>
</main>

<footer>
  <div class="footer-nav">
    <a href="index.html"><i class="fas fa-home"></i><span>Home</span></a>
    <a href="recent.html"><i class="fas fa-history"></i><span>Recent</span></a>
    <a href="app.html"><i class="fas fa-calendar"></i><span>Appointments</span></a>
    <a href="profile.html"><i class="fas fa-user"></i><span>Profile</span></a>
  </div>
  <p>&copy; 2025 EthioGov Public Service</p>
</footer>

<script>
async function loadProfile() {
  const statusMessage = document.getElementById("statusMessage");
  const profileHeader = document.getElementById("profileHeader");
  const profileFields = document.getElementById("profileFields");

  try {
    // Simulated server request (replace with your real server URL)
    const response = await fetch("https://jsonplaceholder.typicode.com/users/1");

    if (!response.ok) throw new Error("Network response was not ok");

    const user = await response.json();

    if (!user) {
      // No user returned
      statusMessage.innerHTML = 'Account not found. <a href="signup.html">Register here</a>';
      return;
    }

    // Display profile
    statusMessage.style.display = "none";
    profileHeader.style.display = "flex";
    profileFields.style.display = "block";

    document.getElementById("profileName").innerText = user.name;
    document.getElementById("profileEmail").innerText = user.email;
    document.getElementById("name").value = user.name;
    document.getElementById("email").value = user.email;
    document.getElementById("phone").value = user.phone;

  } catch (error) {
    console.error(error);
    statusMessage.innerText = "Connection problem. Please try again later.";
  }
}

loadProfile();

// Edit / Save
const editBtn = document.getElementById("editBtn");
const saveBtn = document.getElementById("saveBtn");
const inputs = document.querySelectorAll("#profileFields input");

editBtn.addEventListener("click", () => {
  inputs.forEach(i => i.disabled = false);
  editBtn.style.display = "none";
  saveBtn.style.display = "inline-block";
});

saveBtn.addEventListener("click", async () => {
  const updatedData = {
    name: document.getElementById("name").value,
    email: document.getElementById("email").value,
    phone: document.getElementById("phone").value
  };
  console.log("Saving to backend:", updatedData);

  try {
    await fetch("https://jsonplaceholder.typicode.com/users/1", {
      method: "PUT",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(updatedData)
    });
    document.getElementById("profileName").innerText = updatedData.name;
    document.getElementById("profileEmail").innerText = updatedData.email;
    inputs.forEach(i => i.disabled = true);
    saveBtn.style.display = "none";
    editBtn.style.display = "inline-block";
    alert("Profile saved!");
  } catch (err) {
    console.error(err);
    alert("Error saving profile.");
  }
});
</script>
</body>
</html>
